
import { cn } from "@/lib/utils";
import { useState, useEffect } from "react";
import { MenuItems } from "./sidebar/MenuItems";
import { BetaPrompt } from "./sidebar/BetaPrompt";
import { CollapseButton } from "./sidebar/CollapseButton";

const SIDEBAR_STATE_KEY = "sidebar-collapsed-state";

const menuItems = [{
  icon: () => (
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M6.5 13C8.98528 13 11 15.0147 11 17.5C11 19.9853 8.98528 22 6.5 22C4.01472 22 2 19.9853 2 17.5C2 15.0147 4.01472 13 6.5 13ZM18.8018 13C20.568 13 22 14.432 22 16.1982V18.8018C22 20.568 20.568 22 18.8018 22H16.1982C14.432 22 13 20.568 13 18.8018V16.1982C13 14.432 14.432 13 16.1982 13H18.8018ZM6.5 15C5.11928 15 4 16.1193 4 17.5C4 18.8807 5.11928 20 6.5 20C7.88072 20 9 18.8807 9 17.5C9 16.1193 7.88072 15 6.5 15ZM16.1982 15C15.5365 15 15 15.5365 15 16.1982V18.8018C15 19.4635 15.5365 20 16.1982 20H18.8018C19.4635 20 20 19.4635 20 18.8018V16.1982C20 15.5365 19.4635 15 18.8018 15H16.1982ZM7.80176 2C9.56804 2 11 3.43196 11 5.19824V7.80176C11 9.56804 9.56804 11 7.80176 11H5.19824C3.43196 11 2 9.56804 2 7.80176V5.19824C2 3.43196 3.43196 2 5.19824 2H7.80176ZM16.8906 2.28809C17.6505 1.94928 18.5465 2.19417 19.0303 2.86816L19.1279 3.01855L19.1289 3.02051L21.7666 7.63184L21.8213 7.73438C21.94 7.97701 22 8.24169 22 8.50781C22 9.47982 21.2107 10.2637 20.2422 10.2637H14.9609C14.731 10.2637 14.5036 10.219 14.293 10.1328L14.0879 10.0332L14.085 10.0303C13.2447 9.54647 12.9532 8.47486 13.4355 7.63281L16.0791 3.01953V3.02051C16.2363 2.74598 16.4623 2.52273 16.7305 2.36914L16.8906 2.28809ZM5.19824 4C4.53653 4 4 4.53653 4 5.19824V7.80176C4 8.46347 4.53653 9 5.19824 9H7.80176C8.46347 9 9 8.46347 9 7.80176V5.19824C9 4.53653 8.46347 4 7.80176 4H5.19824ZM15.3789 8.26367H19.8232L17.6035 4.38184L15.3789 8.26367Z" fill="#C0C0C0"/>
    </svg>
  ),
  label: "Dashboard",
  path: "/"
}, {
  icon: () => (
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M8.98438 18.75C9.73114 18.8258 10.3144 19.4562 10.3145 20.2236C10.3145 21.0423 9.65071 21.7051 8.83301 21.7051C8.06558 21.7051 7.43511 21.1219 7.35938 20.375L7.35156 20.2236L7.35938 20.0723C7.43524 19.3255 8.06556 18.7422 8.83301 18.7422L8.98438 18.75ZM18.1953 18.75C18.942 18.8258 19.5253 19.4562 19.5254 20.2236C19.5254 21.0424 18.8616 21.7051 18.0439 21.7051C17.2766 21.7051 16.6461 21.122 16.5703 20.375L16.5625 20.2236L16.5703 20.0723C16.6462 19.3254 17.2766 18.7422 18.0439 18.7422L18.1953 18.75ZM5.16699 2.01465C5.55628 2.08179 5.87643 2.37557 5.96973 2.77051L6.54883 5.22168L19.8701 5.11426C21.2957 5.10131 22.323 6.47777 21.9062 7.84082L21.9072 7.8418L20.0752 13.8457C19.6887 15.115 18.6182 16.0453 17.3262 16.2646L17.0645 16.2988C15.7099 16.4244 14.6527 16.5231 13.5957 16.6211L10.127 16.9424C8.61931 17.0823 7.23237 16.1603 6.75879 14.751L6.67676 14.4619L4.20508 4H3C2.44772 4 2 3.55228 2 3C2 2.44772 2.44772 2 3 2H4.99609L5.16699 2.01465ZM7.02051 7.21875L8.62305 14.002L8.6543 14.1123C8.83562 14.6523 9.36674 15.0046 9.94238 14.9512L13.4111 14.6289C14.4679 14.5309 15.5247 14.4332 16.8789 14.3076L16.9912 14.293C17.542 14.1994 17.9977 13.8027 18.1621 13.2627V13.2617L19.9941 7.25781V7.25684L19.9971 7.2041C19.9875 7.15435 19.9439 7.1139 19.8887 7.11426H19.8877L7.02051 7.21875ZM15.1064 9.7959C15.6107 9.84715 16.0039 10.2733 16.0039 10.791C16.0039 11.3088 15.6107 11.7349 15.1064 11.7861L15.0039 11.791H11.8633C11.311 11.791 10.8633 11.3433 10.8633 10.791C10.8633 10.2387 11.311 9.79102 11.8633 9.79102H15.0039L15.1064 9.7959Z" fill="#C0C0C0"/>
    </svg>
  ),
  label: "Orders",
  path: "/orders"
}, {
  icon: () => (
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M10.5977 2.35156C11.6204 1.84934 12.8323 1.88516 13.8281 2.45898H13.8291L19.5078 5.73828H19.5088L19.7031 5.85938C20.0903 6.11902 20.4141 6.45229 20.6631 6.83301C20.6963 6.87376 20.7277 6.91693 20.7549 6.96387C20.7779 7.00368 20.7955 7.04552 20.8125 7.08691C21.0768 7.57837 21.2246 8.13408 21.2246 8.71191V15.2695C21.2246 16.4189 20.6488 17.4872 19.7021 18.1211L19.5078 18.2422L13.8291 21.5215L13.8281 21.5205C13.3659 21.7873 12.8575 21.938 12.3428 21.9727C12.2696 21.9897 12.1936 22 12.1152 22C12.0379 22 11.9629 21.9902 11.8906 21.9736C11.3726 21.9402 10.8606 21.7891 10.3955 21.5205V21.5215L4.71582 18.2422V18.2412C3.65465 17.6284 3 16.4953 3 15.2695V8.71191C3.00001 7.48449 3.65518 6.35162 4.71582 5.73828L10.3955 2.45898H10.3965L10.5977 2.35156ZM5 15.2695C5 15.7173 5.20968 16.1356 5.55859 16.4043L5.71582 16.5098L11.1152 19.627V12.5361L8.91406 11.2617V12.2822C8.91383 12.8343 8.4662 13.2822 7.91406 13.2822C7.36192 13.2822 6.91429 12.8343 6.91406 12.2822V10.1045L5 8.99805V15.2695ZM13.1152 12.5371V19.623L18.5078 16.5098L18.666 16.4043C19.0148 16.1356 19.2246 15.7172 19.2246 15.2695V9.00391L13.1152 12.5371ZM9.9209 9.53516L12.1162 10.8057L18.1943 7.28906L15.9971 6.02051L9.9209 9.53516ZM12.8291 4.19238C12.3851 3.93658 11.8386 3.93654 11.3945 4.19238L11.3936 4.19141L6.03418 7.28613L7.9248 8.37988L13.999 4.86621L12.8291 4.19141V4.19238Z" fill="#C0C0C0"/>
    </svg>    
  ),
  label: "Products",
  path: "/products"
}, {
  icon: () => (
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M9.77539 14.2656C12.3526 14.2657 14.2284 14.9689 15.4717 16.0898C16.7133 17.2093 17.2334 18.6661 17.2334 19.9814C17.2334 20.5336 16.7855 20.9812 16.2334 20.9814C15.6811 20.9814 15.2334 20.5337 15.2334 19.9814C15.2334 19.1873 14.9205 18.2862 14.1318 17.5752C13.3448 16.8657 11.992 16.2657 9.77539 16.2656C7.55986 16.2656 6.20657 16.8694 5.41895 17.583C4.62891 18.2989 4.31641 19.2057 4.31641 20C4.3162 20.5521 3.86857 21 3.31641 21C2.76425 21 2.31661 20.5521 2.31641 20C2.31641 18.6857 2.83567 17.2246 4.07617 16.1006C5.31915 14.9744 7.19587 14.2656 9.77539 14.2656ZM17.5527 13.9502L17.6543 13.9658L17.9443 14.0312C19.368 14.3845 20.3833 15.1059 21.043 16.0107C21.7338 16.9583 21.9863 18.0402 21.9863 18.9648C21.9863 19.5171 21.5386 19.9648 20.9863 19.9648C20.4342 19.9647 19.9863 19.517 19.9863 18.9648C19.9863 18.3854 19.8257 17.7356 19.4268 17.1885C19.0647 16.692 18.4639 16.22 17.459 15.9717L17.252 15.9248L17.1533 15.8994C16.6694 15.748 16.3695 15.2515 16.4736 14.7441C16.5778 14.2371 17.0486 13.8991 17.5527 13.9502ZM9.77344 3C12.6043 3.00015 14.8984 5.29511 14.8984 8.12598C14.8983 10.9567 12.6042 13.2508 9.77344 13.251C6.94339 13.251 4.6486 10.9566 4.64844 8.12598C4.64844 5.29517 6.94328 3 9.77344 3ZM16.6377 4.66895L16.7393 4.68555L16.9111 4.72461C18.6159 5.15848 19.8873 6.66898 19.9619 8.48828L19.9658 8.6709C19.9594 10.4071 18.864 11.8844 17.3291 12.458C16.8118 12.6512 16.2353 12.3884 16.042 11.8711C15.8489 11.3539 16.1119 10.7784 16.6289 10.585C17.409 10.2934 17.9625 9.54263 17.9658 8.66406L17.958 8.48047C17.8855 7.63032 17.2962 6.92553 16.5039 6.68652L16.3311 6.64258L16.2324 6.61719C15.749 6.46428 15.4509 5.96697 15.5566 5.45996C15.6623 4.95329 16.1338 4.61641 16.6377 4.66895ZM9.77344 5C8.04815 5 6.64844 6.39944 6.64844 8.12598C6.6486 9.85232 8.04825 11.251 9.77344 11.251C11.4996 11.2508 12.8983 9.85208 12.8984 8.12598C12.8984 6.39969 11.4997 5.00015 9.77344 5Z" fill="#C0C0C0"/>
    </svg>
  ),
  label: "Customers",
  path: "/customers"
}, {
  icon: () => (
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M9.46289 2.01367C10.4516 2.01371 11.3803 2.48021 11.9727 3.26855L12.8281 4.40625L12.915 4.50781C13.13 4.73287 13.4286 4.86328 13.7441 4.86426H16.3945C18.2349 4.86426 19.7254 5.3358 20.7188 6.49902C21.6811 7.62599 22 9.2035 22 10.999V11.0049L21.9736 15.6602C21.9725 17.5311 21.4165 19.142 20.2725 20.2861C19.1273 21.4313 17.5144 21.9873 15.6406 21.9873H8.34473C6.46762 21.9873 4.85133 21.432 3.7041 20.2871C2.55669 19.1419 2 17.5281 2 15.6543V8.3418C2 6.57619 2.31822 4.97121 3.25293 3.79785C4.22558 2.57692 5.70731 2.01367 7.58789 2.01367H9.46289ZM7.58789 4.01367C6.11276 4.01367 5.29964 4.43863 4.81738 5.04395C4.29724 5.69686 4 6.75655 4 8.3418V15.6543C4 17.1351 4.43337 18.1886 5.11719 18.8711C5.80134 19.5539 6.85832 19.9873 8.34473 19.9873H15.6406C17.1224 19.9873 18.176 19.5544 18.8584 18.8721C19.5408 18.1896 19.9736 17.1358 19.9736 15.6543V15.6494L20 10.999L19.9863 10.418C19.9216 9.13069 19.635 8.30944 19.1982 7.79785C18.7299 7.24943 17.9178 6.86426 16.3945 6.86426H13.7383C12.7525 6.86131 11.825 6.39734 11.2314 5.61035L11.2305 5.60938L10.374 4.4707V4.46973C10.158 4.18222 9.82031 4.01371 9.46289 4.01367H7.58789ZM13.2803 11.9717C13.9058 11.3775 14.9086 11.3861 15.5234 12.0225H15.5244L17.3848 13.9512L17.4521 14.0283C17.7653 14.4267 17.7318 15.0058 17.3594 15.3652C16.9867 15.7247 16.4065 15.7375 16.0195 15.4102L15.9453 15.3398L14.3955 13.7334L12.3555 16.1436V16.1445C11.769 16.8362 10.7375 16.8923 10.0791 16.3047L9.95215 16.1777L9.12012 15.251L8.06152 16.3672L7.9873 16.4385C7.60315 16.7689 7.02305 16.7614 6.64746 16.4053C6.24679 16.0252 6.23037 15.3919 6.61035 14.9912L7.97168 13.5557L8.09668 13.4375C8.70204 12.9226 9.6013 12.9346 10.1924 13.4658L10.3145 13.5879L11.1299 14.4961L13.1602 12.0986L13.2803 11.9717ZM8.74609 9.45312C9.34445 9.51376 9.8125 10.0191 9.8125 10.6348C9.8125 11.2914 9.28005 11.8223 8.625 11.8223C7.96911 11.8223 7.4375 11.2906 7.4375 10.6348C7.4375 9.97892 7.96911 9.44727 8.625 9.44727L8.74609 9.45312Z" fill="#C0C0C0"/>
    </svg>
  ),
  label: "Content",
  path: "/content"
}, {
  icon: () => (
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M14.5586 2.59766C15.636 2.2168 16.7934 2.39962 17.6855 3.13672C18.4462 3.7653 18.9335 4.72576 19.0898 5.89844C20.7265 6.47765 21.9149 8.00319 21.9961 9.81641L22 10.0205C21.9977 11.9026 20.8052 13.5024 19.1357 14.1143V14.2158C19.133 16.6326 16.7356 18.2103 14.54 17.4258L14.3281 17.3418C13.5546 17.0086 12.7952 16.7129 12.0596 16.4453L12.1299 16.9619C12.2288 17.7221 12.3144 18.4202 12.335 18.7119H12.333C12.4285 19.9117 11.7774 21.001 10.6689 21.4229L10.668 21.4219C9.58826 21.8372 8.24435 21.4878 7.52832 20.5039L7.52734 20.5049C7.22228 20.1029 7.03686 19.6507 6.91504 19.2627L6.5332 18.0254C6.39915 17.5856 6.26048 17.1251 6.12207 16.6641L5.51172 14.627L4.99902 14.5303C2.90745 14.1577 1.99778 12.3221 2 10.5449L2.00098 9.44629L2.01172 9.11328C2.1212 7.451 3.04261 5.8132 5.00391 5.46973L5.87988 5.30566C8.04725 4.87405 11.0574 4.08685 14.3447 2.68164L14.5586 2.59766ZM8.03711 16.0889C8.1746 16.5469 8.3126 17.0031 8.44531 17.4385L8.82324 18.6621V18.6631C8.88803 18.8695 8.96019 19.0398 9.03906 19.1738L9.12012 19.2959L9.13965 19.3223C9.299 19.5474 9.67771 19.6616 9.95117 19.5557L9.95801 19.5537L10.042 19.5137C10.2319 19.4051 10.3678 19.1875 10.3408 18.8662L10.3398 18.8525C10.3224 18.604 10.2419 17.9522 10.1465 17.2207L9.94629 15.7344C9.17099 15.4962 8.43418 15.2944 7.74707 15.1221L8.03711 16.0889ZM16.4121 4.67871C16.0626 4.38987 15.6098 4.31596 15.1318 4.52051H15.1309C12.657 5.57799 10.3335 6.29793 8.37793 6.78906L8.375 9.75977C8.37428 10.3119 7.92616 10.7593 7.37402 10.7588C6.82185 10.7581 6.37445 10.3099 6.375 9.75781L6.37793 7.24414C6.34115 7.25156 6.30489 7.26034 6.26855 7.26758L5.34863 7.43945C4.59025 7.57238 4.07098 8.18918 4.00781 9.23438L4.00098 9.44824L4 10.5469C3.99846 11.7214 4.53436 12.4163 5.34961 12.5615H5.35059C5.69134 12.6223 6.05949 12.6923 6.45215 12.7734C6.47187 12.7766 6.49132 12.7809 6.51074 12.7852C7.79671 13.0527 9.3411 13.4366 11.0469 13.9824C11.1238 13.9976 11.1971 14.023 11.2666 14.0547C12.4834 14.4508 13.7794 14.9278 15.1191 15.5049L15.3018 15.5713C16.2176 15.8361 17.1347 15.1643 17.1357 14.2139L17.1455 6.74902L17.1416 6.54297C17.1007 5.54123 16.7524 4.96005 16.4121 4.67871ZM19.1387 11.8398C19.6636 11.4064 19.9992 10.7513 20 10.0176L19.9902 9.79883C19.9318 9.155 19.6147 8.58461 19.1436 8.19336L19.1387 11.8398Z" fill="#C0C0C0"/>
    </svg>
  ),
  label: "Marketing",
  path: "/marketing"
}, {
  icon: () => (
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M16.4453 2.01074C16.967 2.01294 17.4585 2.017 17.8389 2.02344C18.0284 2.02664 18.1951 2.03022 18.3262 2.03516C18.4249 2.03888 18.5837 2.04511 18.7002 2.06543L18.6992 2.06641C20.5647 2.38813 21.9802 4.06865 21.9844 5.96387L22 8.43262C22.0012 9.23663 21.9962 10.0585 21.9746 10.623L21.9473 11.0918C21.8209 12.4624 21.2437 13.642 20.292 14.5996V14.6006C19.2638 15.6345 18.2332 16.6659 17.2021 17.6963L14.1074 20.7852C12.5632 22.3257 10.1813 22.3999 8.57128 20.9531L8.41796 20.8086C7.54181 19.9403 6.66751 19.0697 5.79491 18.1973L3.18261 15.5742C1.58703 13.9643 1.61698 11.4777 3.20605 9.88477L9.33691 3.75391L9.55468 3.54492C10.6615 2.53563 12.0013 2.00997 13.5322 2.00879L16.4453 2.01074ZM13.331 4.01367C12.3927 4.05609 11.5937 4.39113 10.8975 5.02832L10.75 5.16895C8.70546 7.20957 6.66172 9.25139 4.62109 11.2959L4.62206 11.2969C3.79821 12.1227 3.79399 13.3493 4.60351 14.166L7.20898 16.7832C8.07941 17.6535 8.95199 18.5223 9.82616 19.3887L9.98339 19.5303C10.7933 20.1932 11.9191 20.1423 12.6943 19.3691H12.6953L15.7881 16.2822C16.8182 15.2528 17.8474 14.2228 18.874 13.1904L19.1006 12.9443C19.5982 12.3584 19.8834 11.6854 19.9551 10.9082V10.9072L19.9795 10.4883C19.998 9.9746 20.0017 9.2054 20 8.43652L19.9844 5.96875C19.9825 5.04381 19.2671 4.19625 18.3662 4.03711C18.3998 4.04279 18.3827 4.03914 18.251 4.03418C18.1401 4.03 17.9889 4.02558 17.8047 4.02246C17.4374 4.01625 16.9564 4.01293 16.4375 4.01074C15.3998 4.00638 14.2251 4.0083 13.5342 4.00879L13.331 4.01367ZM7.33984 12.6641C7.70595 12.2979 8.28495 12.2754 8.67773 12.5957L8.7539 12.6641L11.3301 15.2402L11.3994 15.3164C11.7196 15.7092 11.6961 16.2882 11.3301 16.6543C10.964 17.0203 10.3849 17.0438 9.99218 16.7236L9.91601 16.6543L7.33984 14.0781L7.27148 14.002C6.95113 13.6092 6.97372 13.0302 7.33984 12.6641ZM15.6621 5.69629C17.1186 5.69076 18.2883 6.83437 18.2978 8.29492V8.2959L18.2851 8.56055C18.1654 9.77778 17.1817 10.7561 15.9687 10.8838L15.7051 10.8984C14.3733 10.9013 13.2492 9.88969 13.1084 8.58496L13.0937 8.31934C13.0877 6.9037 14.2245 5.70017 15.6621 5.69531V5.69629ZM15.5605 7.70801C15.3114 7.76349 15.0925 8.00177 15.0937 8.31055L15.1064 8.4248C15.1635 8.68547 15.407 8.89909 15.7012 8.89844L15.8203 8.88574C16.0518 8.83516 16.2385 8.64358 16.2861 8.4209L16.2978 8.30762C16.2954 7.95931 16.0329 7.69376 15.6689 7.69531H15.668L15.5605 7.70801Z" fill="#C0C0C0"/>
    </svg>
  ),
  label: "Discounts",
  path: "/discounts"
}];

const settingsItems = [{
  icon: () => (
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M13.0926 1.29297C13.7719 1.36137 14.4093 1.66713 14.8895 2.16113C15.4292 2.7164 15.7237 3.46314 15.7118 4.23633H15.7127C15.7139 4.34588 15.7373 4.45363 15.7801 4.55371L15.829 4.65137L15.8319 4.65625L15.8807 4.73047C16.0033 4.8989 16.1812 5.02043 16.3846 5.07324C16.6168 5.13348 16.8635 5.09919 17.0702 4.97754L17.0809 4.97168L17.2127 4.90039C18.5847 4.20399 20.2768 4.6968 21.0536 6.04492L21.6756 7.125C21.7002 7.16762 21.7202 7.21237 21.7381 7.25781C22.4379 8.6251 21.9572 10.3123 20.618 11.0957L20.6102 11.1006C20.4753 11.178 20.3634 11.2899 20.286 11.4248L20.2821 11.4316C20.161 11.6394 20.1275 11.8868 20.1893 12.1191C20.2513 12.3515 20.4037 12.5499 20.6122 12.6699C21.2819 13.0553 21.7703 13.6919 21.9696 14.4385C22.1687 15.1853 22.0627 15.9816 21.6737 16.6494L21.6668 16.6602L21.0077 17.7588C20.1983 19.1354 18.4304 19.6034 17.0448 18.8066V18.8076C16.9129 18.7323 16.7648 18.6899 16.6131 18.6836C16.3749 18.6846 16.146 18.7796 15.9774 18.9482C15.807 19.1188 15.7116 19.3507 15.7127 19.5918V19.6016C15.7049 21.2047 14.4028 22.4999 12.7997 22.5H11.5457C9.94052 22.4998 8.63828 21.2016 8.63266 19.5977L8.62485 19.4883C8.6094 19.3806 8.57232 19.2768 8.51645 19.1826C8.51381 19.1782 8.51121 19.1734 8.50864 19.1689C8.39021 18.9619 8.19408 18.8098 7.96372 18.748C7.73326 18.6864 7.48718 18.7196 7.2811 18.8398C7.27623 18.8427 7.27137 18.8459 7.26645 18.8486C6.59053 19.2275 5.79113 19.3211 5.04575 19.1094C4.30621 18.8992 3.68028 18.405 3.30356 17.7354V17.7363L2.67173 16.6475L2.67075 16.6455C1.8699 15.2576 2.34452 13.4833 3.7313 12.6807L3.73227 12.6797L3.83286 12.6123C4.05534 12.441 4.1892 12.175 4.1893 11.8896C4.1893 11.5635 4.01471 11.2617 3.73227 11.0986L3.72934 11.0967C2.3431 10.29 1.87009 8.51476 2.67075 7.125L2.68247 7.10449L3.35044 6.00586C4.13251 4.67308 5.81451 4.18869 7.17954 4.88184L7.31137 4.95312L7.32407 4.96094C7.44859 5.03481 7.59048 5.07392 7.7352 5.07617C8.20038 5.07315 8.58433 4.72279 8.63657 4.26953L8.64243 4.17676C8.64386 3.41117 8.94771 2.67681 9.48813 2.13379C10.033 1.58641 10.7734 1.2784 11.5457 1.27832H12.7997L13.0926 1.29297ZM11.5457 3.27832C11.3054 3.2784 11.0747 3.37459 10.9051 3.54492C10.7357 3.71534 10.6413 3.94618 10.6424 4.18652C10.6425 4.19291 10.6425 4.19967 10.6424 4.20605C10.6194 5.79821 9.32165 7.07705 7.72934 7.07715H7.7186C7.22511 7.072 6.74182 6.93709 6.31626 6.6875V6.68848C5.87953 6.43837 5.32245 6.58836 5.07114 7.02441C5.06723 7.0312 5.06349 7.03822 5.05942 7.04492L4.40024 8.12891C4.15439 8.56264 4.30199 9.11365 4.73227 9.36621L4.89731 9.46875C5.70107 10.007 6.1893 10.9139 6.1893 11.8896C6.18918 12.9301 5.63329 13.8908 4.73227 14.4111L4.73325 14.4121C4.30235 14.6616 4.15458 15.2119 4.40219 15.6436L5.03403 16.7334L5.04282 16.75C5.16049 16.9623 5.35822 17.1191 5.59165 17.1855C5.796 17.2436 6.01388 17.2287 6.20688 17.1445L6.28794 17.1035C6.95161 16.7216 7.74017 16.6184 8.48032 16.8164C9.22055 17.0145 9.85101 17.4986 10.2352 18.1611H10.2362C10.2372 18.1628 10.2381 18.1653 10.2391 18.167C10.2408 18.1699 10.2433 18.1729 10.245 18.1758H10.244C10.4932 18.6011 10.6275 19.0841 10.6327 19.5771V19.5869L10.6375 19.6807C10.6843 20.1409 11.0732 20.4999 11.5457 20.5H12.7997C13.3021 20.4999 13.7102 20.0942 13.7127 19.5918C13.7115 18.8203 14.0177 18.0799 14.5633 17.5342C15.1113 16.9863 15.8558 16.6799 16.6307 16.6836H16.6532C17.0788 16.695 17.4961 16.7989 17.8768 16.9863L18.0379 17.0713L18.0409 17.0732L18.1239 17.1152C18.5449 17.3041 19.049 17.1486 19.286 16.7412L19.2928 16.7295L19.9461 15.6396C20.0661 15.4323 20.0997 15.1857 20.0379 14.9541C19.9759 14.7217 19.8235 14.5233 19.6151 14.4033C18.9451 14.0179 18.4558 13.3816 18.2567 12.6348C18.0825 11.9814 18.1424 11.2905 18.4207 10.6807L18.5536 10.4248C18.8062 9.98636 19.17 9.62204 19.6082 9.36914L19.6864 9.31836C20.0575 9.04775 20.1727 8.53631 19.9403 8.12891C19.9277 8.10687 19.9179 8.08338 19.9071 8.06055L19.3202 7.04297C19.0688 6.60688 18.5118 6.45686 18.075 6.70703L18.0741 6.70605C17.4119 7.09221 16.6239 7.20148 15.8817 7.00879C15.1354 6.81493 14.4963 6.33209 14.1063 5.66699V5.66602C13.8541 5.23881 13.7179 4.75297 13.7127 4.25684C13.7126 4.24387 13.7133 4.23074 13.7137 4.21777C13.7208 3.97118 13.6278 3.73161 13.4559 3.55469C13.284 3.37783 13.0473 3.27831 12.8006 3.27832H11.5457ZM12.1747 8.25293C14.1826 8.25301 15.8112 9.88072 15.8114 11.8887C15.8114 13.8968 14.1828 15.5253 12.1747 15.5254C10.1667 15.5252 8.53891 13.8967 8.53891 11.8887C8.53914 9.88081 10.1668 8.25315 12.1747 8.25293ZM12.1747 10.2529C11.2714 10.2532 10.5391 10.9854 10.5389 11.8887C10.5389 12.7922 11.2712 13.5252 12.1747 13.5254C13.0782 13.5253 13.8114 12.7922 13.8114 11.8887C13.8112 10.9853 13.0781 10.253 12.1747 10.2529Z" fill="#C0C0C0"/>
    </svg>

  ),
  label: "Settings",
  path: "/settings"
}, {
  icon: () => (
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M12 2C17.5232 2 22 6.47679 22 12C22 17.5221 17.5233 22 12 22C6.47672 22 2 17.5221 2 12C2 6.4768 6.4768 2 12 2ZM14.7812 16.1953C13.984 16.7249 13.0276 17.0341 11.999 17.0342C10.9707 17.0342 10.0146 16.7255 9.21777 16.1963L7.09668 18.3184C8.4512 19.3711 10.1516 20 12 20C13.8484 20 15.5488 19.3711 16.9033 18.3184L14.7812 16.1953ZM5.68066 7.0957C4.62794 8.45026 4 10.1514 4 12C4 13.8485 4.62858 15.5496 5.68164 16.9043L7.80371 14.7822C7.27404 13.9851 6.9649 13.0288 6.96484 12C6.96484 10.9711 7.27297 10.0139 7.80273 9.2168L5.68066 7.0957ZM16.1943 9.21875C16.724 10.0157 17.0342 10.9713 17.0342 12C17.0341 13.0284 16.7238 13.9834 16.1943 14.7803L18.3184 16.9033C19.3711 15.5487 20 13.8482 20 12C20 10.1512 19.3713 8.45034 18.3184 7.0957L16.1943 9.21875ZM11.999 8.96582C10.3232 8.96582 8.96484 10.3242 8.96484 12C8.96498 13.6757 10.3233 15.0342 11.999 15.0342C13.6749 15.0341 15.034 13.6753 15.0342 12C15.0342 10.3246 13.6751 8.96594 11.999 8.96582ZM12 4C10.1509 4 8.44946 4.62841 7.09473 5.68164L9.21777 7.80371C10.0147 7.2745 10.9707 6.96582 11.999 6.96582C13.0276 6.96586 13.984 7.27508 14.7812 7.80469L16.9053 5.68164C15.5505 4.62841 13.8491 4 12 4Z" fill="#C0C0C0"/>
    </svg>
  ),
  label: "Help center",
  path: "/help"
}];

interface SidebarProps {
  onCollapse?: (collapsed: boolean) => void;
}

export const Sidebar = ({
  onCollapse
}: SidebarProps) => {
  // Initialize state from localStorage or default to false
  const [isCollapsed, setIsCollapsed] = useState(() => {
    // Get the initial state from localStorage
    try {
      const savedState = localStorage.getItem(SIDEBAR_STATE_KEY);
      // Return parsed value or default to false if not set
      return savedState ? JSON.parse(savedState) === true : false;
    } catch (error) {
      // If there's any error in parsing, default to false
      return false;
    }
  });

  // Save to localStorage when state changes
  useEffect(() => {
    try {
      localStorage.setItem(SIDEBAR_STATE_KEY, JSON.stringify(isCollapsed));
    } catch (error) {
      // Handle any localStorage errors silently
      console.error("Error saving sidebar state:", error);
    }
    
    // Notify parent component about the collapse state change
    onCollapse?.(isCollapsed);
  }, [isCollapsed, onCollapse]);

  // Toggle collapsed state
  const handleToggleCollapse = () => {
    setIsCollapsed(prevState => !prevState);
  };

  return <div className={cn(
    "fixed top-16 left-0 h-[calc(100vh-4rem)] transition-all duration-300", 
    isCollapsed ? "w-16" : "w-[300px]"
    )}>
      <div className="flex flex-col h-full py-6 relative bg-[#252626]">
        <CollapseButton isCollapsed={isCollapsed} onClick={handleToggleCollapse} />

        <nav className={`flex flex-col flex-1 ${isCollapsed ? "px-2" : "px-4"}`} >

          <MenuItems items={menuItems} isCollapsed={isCollapsed} />

          <div className={`h-px my-8 bg-[#494a4a] ${isCollapsed ? "mx-4" : "mx-8"}`} />

          <MenuItems items={settingsItems} isCollapsed={isCollapsed} />
        </nav>

        <div className="absolute bottom-8 left-0 right-0">
          {!isCollapsed && <BetaPrompt />}
        </div>
      </div>
    </div>;
};

